# 网络 VPN 的设计的一些思考和处理

梗概:

1. 调研和探索

# 调研探索

1. [kytan](https://github.com/changlan/kytan)是一个高性能的点对点 VPN，目的是最小化降低配置和跨平台部署的麻烦。

## kytan

在阅读后，对它的总结和归类如下：

1. 入口
2. CLI: 命令行的处理
3. TCP、UDP、ICMP 包的封装: 用于数据的传输, 使用了 AEAD 加密
4. 平台设备: 跨平台的处理
5. 网络连接: Client, Server, initial connection, tunnel connection

### 相关资料的扩展

#### TUN/TAP 设备

TUN 设备是一种虚拟网络接口，用于实现用户级的网络协议栈或为网络创建虚拟的隧道。TUN 设备通常与其“兄弟”设备 TAP 一起被提及，它们有着略微的不同。操作系统为这些虚拟设备提供了特殊的接口，应用程序可以通过这些接口读取或写入数据，就好像它们是真正的物理设备一样。

1. **TUN 设备**:

   - 作为一个虚拟的网络层设备（Layer 3）存在。
   - 传输的是 IP 包（如 IPv4 或 IPv6 数据包）。
   - 当你希望在用户空间实现网络协议栈或者需要对 IP 数据包进行处理时，可能会使用 TUN 设备。

2. **TAP 设备**:
   - 作为一个虚拟的数据链路层设备（Layer 2）存在。
   - 传输的是以太网帧。
   - 当你需要在用户空间处理以太网帧，或者模拟一个真实的网络环境时，可能会使用 TAP 设备。

应用场景：

- **虚拟化**：TUN 和 TAP 常用于虚拟化技术中，使虚拟机能够通过这些虚拟接口与宿主机或其他虚拟机进行通信。
- **VPN（虚拟专用网络）**：例如，OpenVPN 就可以使用 TUN 或 TAP 模式来实现。在 TUN 模式下，OpenVPN 处理的是 IP 数据包；在 TAP 模式下，OpenVPN 处理的是以太网帧。
- **网络模拟与测试**：可以使用 TUN 和 TAP 设备在用户空间中模拟网络环境。
